# ğŸ¯ DigitalOcean éƒ¨ç½²ä¿®å¤å®Œæˆæ‘˜è¦

## âœ… **å·²å®Œæˆçš„ä¿®å¤å·¥ä½œ**

### **ğŸ”§ Docker é…ç½®ä¿®å¤**
- [x] **entity-search**: ä¿®å¤ç«¯å£ 3002 â†’ 3003
- [x] **dataset-matching**: ä¿®å¤ç«¯å£ 3002 â†’ 3004
- [x] **data-management**: ä¿®å¤ç«¯å£ 3002 â†’ 3005
- [x] **dataset-search**: ä¿®å¤å¥åº·æ£€æŸ¥ç«¯å£ 3002 â†’ 3006
- [x] **user-management**: ç«¯å£é…ç½®éªŒè¯æ­£ç¡® (3007)

### **ğŸ“‹ Docker Compose é…ç½®**
- [x] æ·»åŠ ç¼ºå¤±çš„ `user-management` æœåŠ¡é…ç½®
- [x] é…ç½®æ‰€æœ‰ 6 ä¸ªå¾®æœåŠ¡çš„ç«¯å£æ˜ å°„ (3002-3007)
- [x] ç§»é™¤ Redis ç«¯å£å¤–éƒ¨æš´éœ² (å®‰å…¨åŠ å›º)
- [x] å¯ç”¨ Redis å¯†ç è®¤è¯
- [x] æ›´æ–°æ‰€æœ‰æœåŠ¡ä½¿ç”¨å¸¦å¯†ç çš„ Redis è¿æ¥

### **ğŸ”’ å®‰å…¨é…ç½®åŠ å›º**
- [x] Redis åªåœ¨ Docker å†…éƒ¨ç½‘ç»œå¯è®¿é—®
- [x] æ‰€æœ‰å®¹å™¨ä»¥é root ç”¨æˆ·è¿è¡Œ
- [x] åˆ›å»ºç”Ÿäº§ç¯å¢ƒå˜é‡æ¨¡æ¿
- [x] æ·»åŠ ç½‘ç»œå®‰å…¨é…ç½®æŒ‡å—
- [x] é…ç½®è®¤è¯å’Œé€Ÿç‡é™åˆ¶

### **ğŸ“š æ–‡æ¡£å’Œå·¥å…·**
- [x] åˆ›å»º `DEPLOYMENT_SECURITY.md` å®‰å…¨æŒ‡å—
- [x] åˆ›å»º `.env.production.example` ç¯å¢ƒå˜é‡æ¨¡æ¿
- [x] åˆ›å»º `verify-deployment.sh` éªŒè¯è„šæœ¬
- [x] åˆ›å»º `DEPLOYMENT_SUMMARY.md` éƒ¨ç½²æ‘˜è¦

## ğŸš€ **éƒ¨ç½²å°±ç»ªçŠ¶æ€**

### **âœ… é…ç½®éªŒè¯é€šè¿‡**
```
ğŸ“ å¿…éœ€æ–‡ä»¶: å®Œæ•´
ğŸ³ Dockerfile ç«¯å£: æ­£ç¡®
ğŸ”§ Docker Compose: æ­£ç¡®
ğŸ”’ å®‰å…¨é…ç½®: å·²åŠ å›º
ğŸ“Š æœåŠ¡ç»“æ„: 6 ä¸ªå¾®æœåŠ¡
ğŸ“ æ–‡æ¡£: å®Œå¤‡
```

### **ğŸ—ï¸ æ¶æ„æ¦‚è§ˆ**
```
Frontend (3001) â†’ [DigitalOcean Load Balancer] â†’ API Gateway
                                                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ChainReactions Backend                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚ entity-relationsâ”‚ entity-search   â”‚ dataset-matchingâ”‚         â”‚
â”‚  â”‚      3002       â”‚      3003       â”‚      3004       â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚ data-management â”‚ dataset-search  â”‚ user-management â”‚         â”‚
â”‚  â”‚      3005       â”‚      3006       â”‚      3007       â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                           â”‚
â”‚  â”‚      Redis      â”‚  â† ä»…å†…éƒ¨è®¿é—®ï¼Œå¯†ç ä¿æŠ¤                     â”‚
â”‚  â”‚      6379       â”‚                                           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“‹ **éƒ¨ç½²æ­¥éª¤**

### **1. ç¯å¢ƒå‡†å¤‡**
```bash
# åœ¨ DigitalOcean Droplet ä¸Š
git clone <your-repo>
cd chainreactions_backend

# é…ç½®ç¯å¢ƒå˜é‡
cp .env.production.example .env
# ç¼–è¾‘ .env æ–‡ä»¶ï¼Œå¡«å…¥çœŸå®çš„ API å¯†é’¥
```

### **2. å¯åŠ¨æœåŠ¡**
```bash
# æ„å»ºå¹¶å¯åŠ¨æ‰€æœ‰æœåŠ¡
docker-compose down
docker-compose build --no-cache
docker-compose up -d

# éªŒè¯æœåŠ¡çŠ¶æ€
./verify-deployment.sh
```

### **3. å®‰å…¨é…ç½®**
```bash
# é…ç½®é˜²ç«å¢™
sudo ufw enable
sudo ufw allow ssh
sudo ufw allow 80
sudo ufw allow 443

# å®‰è£… Nginx (å¦‚éœ€è¦)
sudo apt update && sudo apt install nginx
```

## ğŸ” **å®‰å…¨è¦æ±‚æ¸…å•**

### **å¿…é¡»é…ç½®çš„ç¯å¢ƒå˜é‡**
```bash
# API å¯†é’¥
GEMINI_API_KEY=                    # Google AI Studio
BRIGHT_DATA_API_KEY=               # Bright Data æ§åˆ¶å°
LINKUP_API_KEY=                    # Linkup æ§åˆ¶å°
LINKUP_API_KEY_2=                  # Linkup å¤‡ç”¨å¯†é’¥

# Supabase é…ç½®
SUPABASE_URL=                      # Supabase é¡¹ç›® URL
SUPABASE_ANON_KEY=                 # Supabase åŒ¿åå¯†é’¥
SUPABASE_SERVICE_ROLE_KEY=         # Supabase æœåŠ¡å¯†é’¥

# å®‰å…¨å¯†é’¥
JWT_SECRET=                        # è‡³å°‘ 32 å­—ç¬¦éšæœºå­—ç¬¦ä¸²
REFRESH_TOKEN_SECRET=              # è‡³å°‘ 32 å­—ç¬¦éšæœºå­—ç¬¦ä¸²
REDIS_PASSWORD=                    # è‡³å°‘ 16 å­—ç¬¦éšæœºå­—ç¬¦ä¸²
```

### **æ¨èçš„ DigitalOcean é…ç½®**
- **Droplet è§„æ ¼**: è‡³å°‘ 2GB RAM, 2 vCPU
- **å­˜å‚¨**: 50GB SSD
- **è´Ÿè½½å‡è¡¡å™¨**: DigitalOcean Load Balancer
- **CDN**: Cloudflare (å¯é€‰ï¼Œæ¨è)
- **SSL**: Let's Encrypt æˆ– DigitalOcean æ‰˜ç®¡è¯ä¹¦

## ğŸ“Š **ç›‘æ§å’Œå¥åº·æ£€æŸ¥**

### **æœåŠ¡ç«¯å£æ˜ å°„**
| æœåŠ¡ | ç«¯å£ | å¥åº·æ£€æŸ¥è·¯å¾„ |
|------|------|-------------|
| entity-relations | 3002 | `/api/health` |
| entity-search | 3003 | `/api/health` |
| dataset-matching | 3004 | `/api/health` |
| data-management | 3005 | `/api/health` |
| dataset-search | 3006 | `/api/health` |
| user-management | 3007 | `/api/health` |
| Redis | 6379 | å†…éƒ¨ä»… |

### **éªŒè¯å‘½ä»¤**
```bash
# æ£€æŸ¥æ‰€æœ‰æœåŠ¡çŠ¶æ€
docker-compose ps

# æ‰§è¡Œå¥åº·æ£€æŸ¥
for port in 3002 3003 3004 3005 3006 3007; do
    curl -f http://localhost:$port/api/health
done

# æŸ¥çœ‹æœåŠ¡æ—¥å¿—
docker-compose logs [service-name]
```

## ğŸ†˜ **æ•…éšœæ’é™¤**

### **å¸¸è§é—®é¢˜è§£å†³**
1. **æœåŠ¡æ— æ³•å¯åŠ¨**: æ£€æŸ¥ `.env` æ–‡ä»¶é…ç½®
2. **Redis è¿æ¥å¤±è´¥**: éªŒè¯ `REDIS_PASSWORD` é…ç½®
3. **API è°ƒç”¨å¤±è´¥**: æ£€æŸ¥ç›¸åº” API å¯†é’¥
4. **ç«¯å£å†²çª**: ç¡®ä¿ 3001-3007 ç«¯å£å¯ç”¨

### **è·å–å¸®åŠ©**
```bash
# æŸ¥çœ‹è¯¦ç»†æ—¥å¿—
docker-compose logs -f [service-name]

# é‡å¯æœåŠ¡
docker-compose restart [service-name]

# å®Œå…¨é‡å»º
docker-compose down
docker-compose build --no-cache
docker-compose up -d
```

---

## ğŸ‰ **éƒ¨ç½²å°±ç»ªç¡®è®¤**

âœ… **æ‰€æœ‰é…ç½®é—®é¢˜å·²ä¿®å¤**
âœ… **å®‰å…¨é…ç½®å·²åŠ å›º**
âœ… **æ–‡æ¡£å’Œå·¥å…·å·²å®Œå¤‡**
âœ… **éªŒè¯è„šæœ¬é€šè¿‡**

**æ‚¨çš„ ChainReactions Backend ç°åœ¨å·²å‡†å¤‡å¥½éƒ¨ç½²åˆ° DigitalOceanï¼**

### **æœ€åæ£€æŸ¥æ¸…å•**
- [ ] é…ç½®æ‰€æœ‰å¿…éœ€çš„ç¯å¢ƒå˜é‡
- [ ] è®¾ç½® DigitalOcean Droplet (2GB+ RAM)
- [ ] é…ç½®é˜²ç«å¢™è§„åˆ™
- [ ] è®¾ç½®è´Ÿè½½å‡è¡¡å™¨ (å¯é€‰ä½†æ¨è)
- [ ] é…ç½® SSL è¯ä¹¦
- [ ] è®¾ç½®ç›‘æ§å’Œå¤‡ä»½

**å¼€å§‹éƒ¨ç½²**: `docker-compose up -d` ğŸš€